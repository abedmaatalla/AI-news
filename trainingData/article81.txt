 how a brutal government used cutting edge spyware to hijack one activist s life a spy in the machinehow a brutal government used cutting edge spyware to hijack one activist s lifeby amar toor amp russell brandomin november , during the dead of night , five black cars pulled up in front of the home of moosa abd ali ali . the doors opened , and a group of men stepped out . they could ve been officers , or maybe they were just hired muscle such distinctions aren t always clear in bahrain . but moosa knew they were sent by the government , and they had come for him . moosa was just at the time , but he had already become a prominent anti government activist within the small kingdom of bahrain . he d spent years protesting for equal employment rights and had been jailed and tortured on several occasions . when the cars pulled up outside his home that night , he had just served a nine month prison sentence on charges that were never revealed to him . the men barged into moosa s house and dragged him out into the streets of al akar , the seaside village where he lived with his wife and young son . they took him to a quiet , darkened alleyway and took turns beating him . then they raped him . if he didn t stop his activism , they told him , they would do the same to his family . moosa didn t leave his house for a week after the assault . on december st , , he fled for london , after narrowly sliding by bahraini security forces at the airport . if i stayed in bahrain i would have died in prison , he says . i am sure of it . he hasn t been home since . his torturers were now thousands of miles away . or so he thoughtmoosa became an activist at the age of , when he saw one of his favorite teachers being carried away in handcuffs by a group of policemen . he was politically naive at the time , but the teacher s arrest lit a fire . days later , he joined his very first protest an act for which he was held at gunpoint in his home and sent to jail for five months . now , moosa has spent most of his life campaigning for democracy and equal rights in bahrain , a middle east island nation of . million that has been ruled by the khalifa family dynasty for more than years . he s been jailed seven times not a small number , he says and has endured brutal torture and assault at the hand of bahraini officials . bahrain s government has a long and dubious human rights record , especially when it comes to free speech . even the smallest forms of dissent are regularly met with severe punishment , and the crackdown has only intensified following the arab spring uprisings of . this month , a prominent activist was sentenced to six months in prison over tweets that were critical of the country s defense and interior ministries . bahrain has also been a longtime ally of the united states and particularly the uk , a relationship the kingdom has maintained despite ongoing unrest . that s why moosa fled to london . if he couldn t continue fighting from within bahrain , he could at least do it from bahrain s closest and historically most important global partner . bahrain was effectively a british protectorate until . he was granted asylum in , his wife and child joined him a year later , and for a while , it seemed as if he was finally safe . he found a job as a cameraman for a bahraini news agency and embedded himself within london s community of exiled activists . he was definitely still on the bahraini government s radar his high profile demonstrations and sizable social media following made sure of it but he was finally free to protest , and his torturers were now thousands of miles away . or so he thought . one day in , moosa opened the facebook messenger app on his iphone . what he saw was chilling someone else typing under his name to an activist friend of his in bahrain . whoever it was kept posing personal questions prodding for information , and moosa watched unfold right before eyes . he panicked . it was like , what s going on ? what s happening ? he recalls . he changed his password , alerted his friend , and stopped using facebook messenger but the intrusions kept coming . in another instance , moosa noticed that someone posing as him solicited his female facebook friends for sex part of an effort , it seemed , to blackmail or perhaps defame him in bahrain s conservative media . facebook was only the beginning . unbeknownst to him , moosa s phone and computer had been infected with a highly sophisticated piece of spyware , built and sold in secret . the implant effectively commandeered his digital existence , collecting everything he did or said online . the implant effectively commandeered his digital existenceupon his arrival in london , moosa had become an unofficial archivist for his activist community , obsessively documenting every protest and broadcasting his videos to a large group of youtube followers . whenever something happened back in bahrain , he d receive a flurry of images and video footage from contacts and disseminate the content online and to media outlets . now , whoever was behind the hack had access to all of his accounts , emails , documents , and a massive trove of videos . they could even control his computer s webcam and microphone . an investigation would later reveal that moosa s online life was hijacked for eight months . all signs pointed to bahrain as the culprit , and finfisher , a mysterious spyware for hire tool , as the weapon of choice . it was may of when morgan marquis boire first got the package from bahrain . he was working on google s incident response team at the time , protecting high risk users from state sponsored attackers . he has since become security director for first look media . along the way , he d seen a lot of spyware being sent after protesters during the arab spring . most of the implants he ran into were easy to spot and remove . but this one , arriving in a protected attachment from bahrainwatch , seemed more complicated . following standard procedure , marquis boire set the program running in a virtual machine , essentially a fish tank where he could watch the virus at work . he watched the virtual machine s working memory , keeping his eye on the software as it stretched its legs in the new environment . holy shit , i think this is finfisher ! then , without warning , the implant disappeared . that got marquis boire s attention . i thought , oh we have a player here , he recalls . it was a sign of a more sophisticated author at work . the implant used a technique called process hollowing injecting its own code into a program that s still running in order to use the legitimate program as cover . digging through the working memory , marquis boire found the implant hiding in winlogon . exe , and he could see the new files that had rushed in to replace the old ones . one line of code stuck out , left over from a file path on the implant developer s computer y lsvn branches finspyv . finspyv src libs libgmp mpn tdiv qr . c i thought , finspy , that rings some bells , marquis boire recalls . holy shit , i think this is finfisher ! finfisher had become a kind of bogeyman in the security community since brochures advertising the software s capabilities popped up in a wikileaks drop in december of . finfisher could purportedly empower its owner with the kinds of advanced intrusion techniques usually reserved for the nsa . there was a certain amount of interest just because no one had seen it , marquis boire says . all we had were these leaked documents . the cover page of a finfisher document released by wikileaks . finfisher was created and sold by gamma international , an international surveillance company with offices in london and frankfurt . the gamma brochures promised remote monitoring and keylogging they even said they could listen in on a target s skype calls in real time . it s the kind of technology that could be subject to international export restrictions like the wassenaar arrangement , so finding it in the hands of the bahraini government would have major diplomatic consequences . but so far , no one had been able to pin down the program in action . when arab spring protestors found evidence of finfisher use by the mubarak government in egypt , gamma simply said the software had been stolen . no one was ever able to prove otherwise . but now marquis boire had caught a finfisher sample in the wild , and thanks to the leaked brochures , he had a roadmap of everything the implant could do . the implant divided its tasks between different modules , like a crew of bank robbers one module would break through a device s security and then deploy another module to log keystrokes , collecting the target s passwords . a third module took screenshots of the desktop , catching anything the subject might be looking at . a fourth module encrypted the data into a unique file format , so anyone looking through a hard drive wouldn t notice the device was recording anything . once the data was safely encrypted , the implant would send the file back home to its command server in this case , a server at bahrain s national telecom . marquis boire enlisted the aid of claudio guarnieri , a researcher at security firm rapid , to further explore the software . the two uncovered a mobile version of the implant , which came in different versions for ios , android , and even symbian , like a hot startup trying to cover as much of the market as possible . the new platform enabled dangerous new features like tracking targets through gps and pulling contacts directly from the phone s memory . there were specific modules for popular chat and voip apps like whatsapp and viber , in case you tried to escape by running to a third party service . it could even activate the on board microphone to listen in from your pocket . once the implant was installed , your phone effectively became an enemy agent . i d be working at my computer and start squinting at my phone , thinking , maybe i should turn that off , marquis boire says . it produced this weird dissonance between me and this device that i carry around all the time . the implant divided its tasks between different modules like a crew of bank robbersthen there were the command servers themselves . after studying the implant , marquis boire and the others were able to recreate the fingerprint it used when it phoned home to the command server , which gave them a new way to catch finfisher in the act . why not send the ping into the wild and see how many servers answered ? if it worked , it would show them all the finfisher installations running on the open web . but finding that out meant sending out a ping to billions of ip addresses at once which also meant finding an extremely understanding traffic provider . i remember telling providers , i want a big box with a lot of bandwidth , marquis boire says . most assumed he wanted it for criminal purposes , rather than to catch hackers in the act . we finally found a provider that i was able to explain it to , and they still accidentally shut down the box halfway through . after a few false starts , the pings finally went out and the team waited to see what would come back . instead of a few outposts , they found an army . finfisher s agents were everywhere japan , germany , india , serbia , mongolia there were even servers in the us . it was an atlas of personal invasions . all told , countries hosted a server of some kind , each hired out to a different regime and pointing the x ray at a different enemy of the state . but while he could see finfisher s control servers , marquis boire still couldn t see who they were working for . one server was on the official government grid of turkmenistan , which made it easy enough to guess who put it there but who was behind the for hire servers in the us ? when they listened in , who did they hear ? the web is a busy place , and it keeps many secrets . a scan can t dig up all of them . gamma s advertised capabilities , from gammagroup . commarquis boire published the work in a series of three landmark papers from july to march of , each titled with a cheeky bond pun like the smartphone who loved me ampnbspor you only click twice . ampnbspthe papers laid out everything he knew about finfisher s network , revealing a global surveillance network that was being hired out to some of the world s most repressive governments . targeted exploits weren t just for the nsa anymore . they were available to anyone who could pay for them . once the papers were published , finfisher went back underground . the coders behind the program began to change its routines and filenames enough to let it slip by unnoticed . soon , the servers weren t responding to the same call marquis boire had sent out . they had new procedures now , new passwords , and they knew they were being watched . marquis boire had gotten his glimpse of the network , but then it knew it had been spotted and sank back into the shadows . still , marquis boire s investigation had dug up enough for a definitive case that finfisher had been used against bahraini activists in london . that left two awkward possibilities either the british government had approved finfisher for export , or gamma never reported the sale . the first option would mean messy publicity for uk officials , revealing that the government had facilitated the ongoing persecution of refugees . the second could be even worse , putting finfisher and other programs directly in the crosshairs of british trade enforcers . and if gamma violated the uk s hacking laws , the fallout could be even greater . in august , the humanitarian rights group bahrain watch published new evidence suggesting that the bahraini government had been using finfisher to conduct surveillance on prominent bahraini lawyers , activists , and politicians , both in bahrain and abroad . according to information from a massive data leak , gamma not only sold finfisher to the bahraini government , but actively worked with the regime to remotely access and monitor the computers and smartphones of opposition activists . gamma did not respond to multiple requests for comment . in the uk , moosa abd ali ali was one of three bahraini exiles allegedly targeted by the government , together with jaffar al hasabi , , and saeed al shehabi , . the devices of all three men were infected in , but the extent of the breach didn t become apparent until recently . gamma actively worked with the regime to access and monitor the activity of opposition activistsmoosa , jaffar , and saeed represent three different generations of bahraini activism , but they re all fighting the same fight . jaffar , tall and soft spoken , has devoted his life to campaigning against the widely documented human rights violations committed by the bahraini government , and has been living in exile in london since the mid s . saeed , a london educated engineer and prominent opposition figure , acts as the elder statesmen of the group , professorial and eloquent with thinning gray hair . all three have been imprisoned and tortured in bahrain jaffar as recently as and all three have had their bahraini citizenship revoked . in london , they re part of a tight knit community of bahraini activists who orchestrate protests , petitions , and other events to raise awareness about the ruling family s abuses and what they see as tacit complicity on the part of the british government . even in the uk , moosa and his compatriots are physically harassed by groups they believe are connected to the bahraini regime . the three were attacked in an alleyway following a demonstration in , the same year that arsonists laid siege to saeed s house in the dead of night . but they never thought that a uk firm would actively work with the bahraini government to monitor them in a country that was supposed to keep them safe . what we didn t expect is that they would go that far by really intruding into our private lives , saeed says over tea at an islamic charity he runs in central london . wary of endangering their families or other activists in bahrain , the men have learned to keep politics out of their conversations and have curtailed their social media activity to varying degrees . we feel that we are not safe , jaffar adds . it limits how we talk and what we can say . using finfisher , the bahraini government effectively undermined the asylum moosa and his compatriots were granted in the uk the kind of cautionary tale of corporate state surveillance that has become increasingly common in recent years . ultimately , the men were lucky . finfisher was detected and wiped from their devices , and a watchdog is pushing for an investigation on their behalf . but while moosa and his friends recover , finfisher is gathering new targets in new countries . many of them may not be as lucky as moosa . one , two , three , four , al asoud , no more ! five , six , seven , eight , saudi is a terror state ! moosa s voice bellows across the leafy streets of central london on a crisp november afternoon . his calls are echoed by saeed , jaffar , and three other bahraini activists , all men . they ve come here to the upscale , commercial district of mayfair to protest directly in front of the saudi arabian embassy , as they do every wednesday afternoon between and pm . saeed and moosa each hold up two large banners urging the british government to stop supporting bahrain s torturers and calling for saudi troops to leave the island nation that they invaded following the arab spring . jaffar patrols the sidewalk , handing out flyers with soft greetings . the demonstration is short and non eventful . louis vuitton clad women politely decline or outright ignore jaffar s extended hand , and the banners draw little more than passing interest and a few iphone clicks . at precisely pm , they pack up their things , under the watchful gaze of embassy guards across the street , and load them into a car with perfunctory swiftness . after the protest , the three men go their separate ways . the sun is weakening and traffic is snarling , but moosa doesn t seem to be in much of a rush , munching potato chips in the back of a car as we lurch closer to his office near the king s cross train station . short and burly with a small mullet , moosa has the build of a guy who carries heavy equipment all day . he s quiet and warm in person , but his friends describe him as a tour de force in london s activist community , his quick smile and soft dark eyes masking years of suffering . i was looking for someone to punch . in my opinion he s one of the bravest people , says sayed ahmed , director of advocacy at the london ngo bahrain institute for rights and democracy bird , and a longtime friend of moosa . most victims , they want to forget what has happened to them , but moosa is the kind of person after what he went through , he only wanted to challenge it , to fight against it . he s so determined . of the three london activists implicated by finfisher , moosa is likely the one with the most to lose . his work revolves around the flow of information and media . his whatsapp conversations update faster than most people s twitter feeds . seated in front of an imac in his agency s king s cross office a converted residence and occasional islamic daycare that also houses bird he eagerly clicks through the vast library of video footage he s collected over the years , stored across six different hard drives protests , official bahraini visits , parliamentary events . if there s a bahrain related happening in the uk , moosa is there , camera in tow . moosa was furious when he first realized his privacy had been compromised i was looking for someone to punch but he s not worried about the government meddling with his videos . he stores them on hard drives and immediately uploads footage to the web once he receives it . if anything , the finfisher saga seems to have emboldened him . a video of moosa confronting tariq alhasan , the official spokesperson of bahrain s ministry of interior , and the rest of the ministry s delegation in geneva on june th , . he s now begun conducting his own form of surveillance , obsessively tracking the online itineraries of bahraini authorities in the hopes of upstaging their events with high profile demonstrations . he s shouted at ambassadors , waved banners in front of dignitaries , and even staged a demonstration directly in front of a seated queen elizabeth ii all in an effort to send a message to his compatriots back home . when you shout at them here , they feel small , moosa says . when they are in bahrain , they are bigger . if anyone talks to them , they are behind bars . but here in the uk , they can t arrest me . when you shout at them here , they feel small . there s no indication that bahraini authorities have used information gleaned from the activists computers against anyone in their network back home , but the possibility weighs heavily . in private , with my family , i speak freely because i don t involve them with politics , jaffar says . but the other friends in bahrain , we are afraid that they would be harmed or jailed . because many people who had been in contact with us are in jail right now , and we fear for the safety of the others . there are many in bahrain right now who are hiding , because they are wanted by the government . their primary concern stems not from what effect finfisher could have on their activism , but from the specter of having their personal lives invaded the same fundamental privacy concern behind much of the nsa surveillance controversies in the us . there are already signs that the bahraini government has sought to discredit the activists online . in , a link to a pornographic website appeared in saeed s twitter feed . he didn t post it and immediately deleted it , but the incident underscores a familiar tactic used to smear opposition figures . mohamed altajer , a bahraini human rights lawyer who was also targeted by finfisher , was blackmailed in with a video of him and his wife having sex . he received the video on the same day that authorities infected his computer , along with a threat to make it public unless he stopped defending activists . in october , a london based watchdog group called privacy international filed a formal complaint with the uk s national crime agency against gamma group . the case was simple a company had violated british hacking laws , breaking into phones and hijacking accounts . what was the government doing about it ? the organization was joined in the suit by moosa , jaffar and saeed , each man testifying to his own experience with digital tracking . they brought evidence marquis boire s report showed how gamma s malware had infiltrated the trio s phones , piping data back to bahrain . new reports from bahrain watch and wikileaks showed gamma employees providing active technical support to bahrain officials . it was easy to connect the dots from moosa to gamma to the bahraini regime . the new complaint just made it official , charging the bahraini government with violating uk hacking law and naming gamma as an accessory . the case was simple a company had violated british hacking lawsbut the international nature of the hack makes it legally complex british german software , sold to bahraini police , who used it to spy on bahraini exiles in london . it s too broad for local law enforcement and too small to warrant an international incident . in the past , gamma has deflected legal action , either by claiming it had nothing to do with finfisher s installation or that the software had been pirated . this time , those denials won t work . but it s still unclear if , or how , british government will respond . the commercial surveillance industry continues to operate with impunity and little moral responsibility , carly nyst , legal director for privacy international , said in an email . it is time for companies like gamma to face the consequences of enabling repressive regimes through the sale of their technology . bill marczak , a research fellow at citizenlab and the co founder of bahrain watch , calls finfisher just the latest step in productized surveillance , an approach pioneered by companies like gamma and milan based hacking team that aims to make digital intrusion as easy and full service as any other government technology package . they actually have a system that the government buys , and they get the whole package , marczak says . it s not just the code itself , it s the administration , the analysis , the support the whole framework is provided . that turns the same surveillance conducted by the nsa or gchq into a market product , available to the highest bidder with no questions asked . the value proposition is essentially activists in your country are giving you trouble ? well here s a product that will allow you to turn their cellphone or computer into basically a wiretap , a surveillance tool , and you can spy on everything they do , marczak says . and i think governments are very attracted to that . the eu added intrusion software to its list of export controlled goods alongside nuclear reactors and anthrax sporesas for finfisher , citizenlab s research shows that the spyware is being used in new countries , suggesting that demand is growing . the organization regularly conducts probes for new finfisher servers , and the latest results , to be released in a few months , will likely paint a sobering picture . it s hard to say whether the total number of customers has gone up , but my suspicion is yes , this has continued to spread , marczak adds . more and more governments are seeking out this technology and using it . this past november , the eu added intrusion software like finfisher to its list of explicitly export controlled goods , alongside nuclear reactors and anthrax spores . but it s still unclear if the new measures will limit the program s dissemination . in the meantime , moosa and his compatriots say they ll continue fighting for change in bahrain , even if that means having to look over their shoulder a few extra times . they ve been beaten , tortured , and terrorized by the country they still call home , but they remain undeterred , buoyed by the belief that a better bahrain is always just around the corner . one day , when the revolution is over and the khalifas are gone , i will take you to bahrain , and i will show you where i worked and how to fish in bahrain , moosa said over the phone last month . it was the evening of december st , eight years to the day since he fled his home for the uk and he was reminiscing about the time he spent working in fish markets as a young man . the memories are distant now , buried by the years of struggle , but in his mind the bahrain of his youth is as vivid as ever . it is so , so lovely , he said of the country that continues to haunt him . the sea is so nice . photography by hal shinnie